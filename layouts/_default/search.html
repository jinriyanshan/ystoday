{{ define "main" }}
<div class="search-container" style="max-width: 800px; margin: 0 auto; padding: 2rem;">
  <h1>ğŸ” ç«™å†…æœç´¢</h1>
  <p>è¾“å…¥å…³é”®è¯ï¼ŒæŸ¥æ‰¾ç‡•å±±æ—§æ—¶å…‰çš„å†…å®¹</p>

  <!-- æœç´¢æ¡† -->
  <input 
    type="text" 
    id="search-input" 
    placeholder="è¾“å…¥å…³é”®è¯æœç´¢..."
    style="
      width: 100%;
      padding: 1rem;
      margin: 1rem 0;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
      background: #333;
      color: #fff;
    "
  >

  <!-- æœç´¢ç»“æœå®¹å™¨ -->
  <div id="search-results" style="margin-top: 2rem;"></div>
</div>

<!-- çº¯å‰ç«¯æœç´¢è„šæœ¬ -->
<script>
  // åŠ è½½ Hugo ç”Ÿæˆçš„ JSON ç´¢å¼•
  fetch('/index.json')
    .then(response => response.json())
    .then(pages => {
      const searchInput = document.getElementById('search-input');
      const searchResults = document.getElementById('search-results');

      // ç›‘å¬è¾“å…¥äº‹ä»¶ï¼Œå®æ—¶æœç´¢
      searchInput.addEventListener('input', () => {
        const query = searchInput.value.toLowerCase().trim();
        if (query.length < 2) {
          searchResults.innerHTML = '<p>è¾“å…¥è‡³å°‘2ä¸ªå­—ç¬¦å¼€å§‹æœç´¢</p>';
          return;
        }

        // è¿‡æ»¤åŒ¹é…çš„é¡µé¢
        const results = pages.filter(page => 
          page.title.toLowerCase().includes(query) || 
          page.content.toLowerCase().includes(query)
        );

        // æ¸²æŸ“ç»“æœ
        if (results.length === 0) {
          searchResults.innerHTML = '<p>æœªæ‰¾åˆ°ç›¸å…³å†…å®¹</p>';
        } else {
          searchResults.innerHTML = `
            <h3>æ‰¾åˆ° ${results.length} æ¡ç»“æœï¼š</h3>
            <ul style="list-style: none; padding: 0;">
              ${results.map(page => `
                <li style="margin: 1rem 0; padding: 1rem; border-bottom: 1px solid #444;">
                  <a href="${page.permalink}" style="color: #66b3ff; font-size: 18px; text-decoration: none;">
                    ${page.title}
                  </a>
                  <p style="color: #aaa; font-size: 14px; margin-top: 0.5rem;">
                    ${page.content.substring(0, 100)}...
                  </p>
                </li>
              `).join('')}
            </ul>
          `;
        }
      });
    })
    .catch(err => {
      console.error('æœç´¢ç´¢å¼•åŠ è½½å¤±è´¥:', err);
      document.getElementById('search-results').innerHTML = '<p>æœç´¢åŠŸèƒ½æš‚æ—¶ä¸å¯ç”¨</p>';
    });
</script>
{{ end }}
